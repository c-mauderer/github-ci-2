name: CI-2

on:
  workflow_dispatch:
    inputs:
      called_from_ci1:
        type: boolean
        default: false
  workflow_call:
    inputs:
      called_from_ci1:
        type: boolean

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3
        with:
          repository: c-mauderer/github-ci-2
      - name: Download artifact
        if: inputs.called_from_ci1 == true
        uses: actions/download-artifact@v3
        with:
          name: my-log
          path: path/to/artifact
      - name: Download artifact from other
        if: inputs.called_from_ci1 == false
        uses: dawidd6/action-download-artifact@v2
        with:
          repo: c-mauderer/github-ci-1
          branch: main
          workflow: one.yml
          workflow_conclusion: success
          name: my-log
          path: path/to/artifact
      - name: Show artifact
        run: |
          pwd
          ls -R
          cat path/to/artifact/log
      - name: Append to artifact
        run: |
          mv path/to/artifact/log .
          echo "Hello from 2" >> log
          git log | head -20 >> log
      - name: Archive artifacts
        uses: actions/upload-artifact@v3
        with:
          name: my-log2
          path: log
